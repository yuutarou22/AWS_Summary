# VPC


## VPCとは
- Virtual Private Cloud
- ユーザ専用のプライベートクラウド環境を構築するサービス
- EC2を内部的に通信したい場合、RDSとデータ通信したりしたい時、内部と外部ネットワークを結ぶ時などに使用する


## VPCで出来ること
### サブネット
VPCネットワークを分割したネットワーク群のこと
下記の2種類がある
- パブリックサブネット
  - 外部ネットワークと直接繋がっている
- プライベートサブネット
  - 直接外部に接続できないサブネット

それぞれのサブネットは、AZを指定する必要がある。
複数のサブネットを作成しておき、別々のAZを指定しておく。冗長化するのが鉄則（っぽい）。

外部からの攻撃を避けるため、極力プライベートサブネットに配置しておくのが無難


### インターネットゲートウェイ（IGW）
VPCと外部ネットワークを繋ぐ境界になるもの。

IGWを作成し、サブネットに繋ぐことでパブリックサブネットとなり、外部ネットワークと通信できる。


### NATゲートウェイ
プライベートサブネットから外部ネットワークに接続可能にするコンポーネント。

内部から外部への通信は可能だが、外部からの通信は不可。


### ルーティング
サブネットを利用するために、各サブネットにルートテーブルを作成する必要がある。

一般的には、ルータ機材があり、ルータに記録される経路情報をもとにルーティング処理を行う。

VPCは、「サブネット内にあるインスタンスがどこに通信するのか」を設定するルールのようなもの。

言い換えると、パケットの宛先（IPアドレス）を参照し、どこにデータを通信して送り届けるかが書かれている表＝ルーティングというわけ。

ちなみに、表がルーティング（通信）の根幹となるため、記載されていない宛先のパケットは通信できない。

サブネットごとに、どこに通信できるか定めたということを押さえておく。

- ルートテーブルにIGWへのルーティングがあれば、パブリックサブネット
- ルートテーブルにIGWへのルーティングがなければ、プライベートサブネット


### ネットワークアクセスコントロール（NACL）
プロトコル、ポート、IPアドレスを入れて許可・不許可するのかを決める。
IPアドレス単位での通信の制御が行える。
